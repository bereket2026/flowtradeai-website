<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>FlowTradeAI</title>
  <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <style>
    body { background:#0b1220;color:#e5e7eb;font-family:Arial;margin:0 }
    header { padding:15px;background:#111827 }
    select,button { padding:8px;width:100%;margin-top:5px }
    .card { background:#111827;padding:15px;margin:10px;border-radius:8px }
  </style>
</head>

<body>

<header>
  <h2>FlowTradeAI</h2>
  <div id="status">Backend: checkingâ€¦</div>
</header>

<div class="card">
  Strategy
  <select id="strategy">
    <option value="scalp">Scalp</option>
    <option value="swing" selected>Swing</option>
    <option value="long">Long</option>
  </select>
</div>

<div class="card">Price: <span id="price">-</span></div>
<div class="card">Signal: <span id="signal">-</span></div>
<div class="card">RSI: <span id="rsi">-</span></div>
<div class="card">MACD: <span id="macd">-</span></div>

<div class="card">
  <button onclick="askAI()">Ask AI</button>
</div>

<div class="card">
  <div id="chart" style="height:300px"></div>
</div>

<script>
const chart = LightweightCharts.createChart(
  document.getElementById("chart"),
  { layout:{background:{color:"#0b1220"},textColor:"#e5e7eb"} }
);
const candles = chart.addCandlestickSeries();

async function askAI() {
  try {
    const res = await fetch(
      "https://YOUR-RENDER-URL.onrender.com/ai",
      {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({
          strategy: document.getElementById("strategy").value
        })
      }
    );
    const d = await res.json();

    document.getElementById("status").innerText = "Backend: ONLINE";
    document.getElementById("price").innerText = "$"+d.price;
    document.getElementById("signal").innerText = d.signal+" ("+d.confidence+"%)";
    document.getElementById("rsi").innerText = d.rsi;
    document.getElementById("macd").innerText = d.macd;

    const t = Math.floor(Date.now()/1000);
    candles.update({
      time:t,
      open:d.price*0.995,
      high:d.price*1.002,
      low:d.price*0.998,
      close:d.price
    });

  } catch {
    document.getElementById("status").innerText = "Backend: sleeping";
  }
}

setTimeout(()=>{ askAI(); setInterval(askAI,30000); },2000);
</script>

</body>
</html>
